-- Crear tabla de Autores
CREATE TABLE Autor (
    id_autor INT PRIMARY KEY,
    nombre_autor VARCHAR(100) NOT NULL
);

-- Crear tabla de Libros
CREATE TABLE Libro (
    id_libro INT PRIMARY KEY,
    titulo VARCHAR(200) NOT NULL,
    precio DECIMAL(10, 2) NOT NULL,
    id_autor INT,
    FOREIGN KEY (id_autor) REFERENCES Autor(id_autor)
);

-- Crear tabla de Clientes
CREATE TABLE Cliente (
    id_cliente INT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    apellido VARCHAR(100) NOT NULL
);

-- Crear tabla de Pedidos
CREATE TABLE Pedido (
    id_pedido INT PRIMARY KEY,
    fecha_pedido DATE NOT NULL,
    id_cliente INT,
    FOREIGN KEY (id_cliente) REFERENCES Cliente(id_cliente)
);

-- Crear tabla de Detalles del Pedido
CREATE TABLE DetallePedido (
    id_pedido INT,
    id_libro INT,
    cantidad INT,
    PRIMARY KEY (id_pedido, id_libro),
    FOREIGN KEY (id_pedido) REFERENCES Pedido(id_pedido),
    FOREIGN KEY (id_libro) REFERENCES Libro(id_libro)
);

-- Insertar datos en la tabla Autor
INSERT INTO Autor VALUES (1, 'Gabriel García Márquez'), (2, 'Isabel Allende');

-- Insertar datos en la tabla Libro
INSERT INTO Libro VALUES 
(1, 'Cien Años de Soledad', 299.99, 1),
(2, 'El Amor en los Tiempos del Cólera', 199.99, 1),
(3, 'La Casa de los Espíritus', 249.99, 2);

-- Insertar datos en la tabla Cliente
INSERT INTO Cliente VALUES 
(1, 'Juan', 'Pérez'),
(2, 'Ana', 'López');

-- Insertar datos en la tabla Pedido
INSERT INTO Pedido VALUES 
(1, '2024-11-24', 1),
(2, '2024-11-23', 2);

-- Insertar datos en la tabla DetallePedido
INSERT INTO DetallePedido VALUES 
(1, 1, 2),
(1, 3, 1),
(2, 2, 1);

-- Consulta simplificada: Mostrar todos los libros y sus autores
SELECT 
    Libro.titulo AS Titulo, 
    Libro.precio AS Precio, 
    Autor.nombre_autor AS Autor
FROM Libro
JOIN Autor ON Libro.id_autor = Autor.id_autor;

-- Consulta adicional: Mostrar pedidos con libros y clientes
SELECT 
    Pedido.id_pedido AS Pedido, 
    Cliente.nombre AS Nombre_Cliente, 
    Cliente.apellido AS Apellido_Cliente,
    Libro.titulo AS Libro, 
    DetallePedido.cantidad AS Cantidad
FROM Pedido
JOIN Cliente ON Pedido.id_cliente = Cliente.id_cliente
JOIN DetallePedido ON Pedido.id_pedido = DetallePedido.id_pedido
JOIN Libro ON DetallePedido.id_libro = Libro.id_libro;



SELECT titulo, precio 
FROM Libro
WHERE id_autor = 1; -- Cambia el ID del autor según sea necesario

UPDATE Libro
SET precio = 350.00
WHERE id_libro = 1; -- Cambia el ID del libro según sea necesario


SELECT 
    Libro.titulo AS Nombre_Libro,
    Libro.precio AS Precio_Libro,
    Cliente.id_cliente AS ID_Cliente,
    CONCAT(Cliente.nombre, ' ', Cliente.apellido) AS Nombre_Cliente
FROM DetallePedido
JOIN Libro ON DetallePedido.id_libro = Libro.id_libro
JOIN Pedido ON DetallePedido.id_pedido = Pedido.id_pedido
JOIN Cliente ON Pedido.id_cliente = Cliente.id_cliente;


